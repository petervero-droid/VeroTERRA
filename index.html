<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#4CAF50" />
  <link rel="manifest" href="manifest.json" />
  <title>Veroterra</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 700px; margin: auto; }
    h1 { text-align: center; }
    input, button, select, textarea { padding: 8px; margin: 4px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    th { background: #4CAF50; color: white; }
    .total { font-weight: bold; margin-top: 10px; }
    .btn { cursor: pointer; background: #4CAF50; color: white; border: none; padding: 8px 12px; border-radius:4px; }
    #productList { width: 100%; }
    #importSection { position: fixed; bottom: -500px; left: 0; opacity: 0; pointer-events: none; }
    #importO { cursor: pointer; color: #4CAF50; font-weight: 700; }
    .small { font-size: 0.9em; color:#555; }
    .top-row { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .top-row input[type=number]{width:120px;}
  </style>
</head>
<body>
  <h1>
    Ver<span id="importO">O</span>terra
  </h1>

  <div class="top-row">
    <input type="text" id="productSearch" placeholder="Type first 3 letters of product">
    <select id="productList"></select>
    Price: <input type="number" id="productPrice" readonly>
    PV: <input type="number" id="productPV" readonly>
    Quantity: <input type="number" id="productQty" value="1">
    <button class="btn" onclick="addProduct()">Add Product</button>
  </div>

  <div style="margin-top:8px;">
    <label class="small">Flat Shipping:</label>
    <input type="number" id="flatShipping" placeholder="Flat Shipping" value="0">
  </div>

  <table id="productTable" aria-live="polite">
    <thead>
      <tr>
        <th>Name</th><th>Price</th><th>PV</th><th>Qty</th><th>Total Price</th><th>Total PV</th><th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="total">
    Grand Total Price: <span id="grandTotalPrice">0</span><br>
    Grand Total PV: <span id="grandTotalPV">0</span>
  </div>

  <div style="margin-top:12px;">
    <button class="btn" onclick="exportOrder()">Export Order (JSON)</button>
    <button class="btn" onclick="clearOrder()">Clear Order</button>
    <span class="small"> • Import CSV is hidden — click the "O" in the title to open</span>
  </div>

  <!-- Hidden Import Section (off-screen) -->
  <div id="importSection">
    <input type="file" id="csvFile" accept=".csv" onchange="importCSV(event)">
    <button class="btn" onclick="exportData()">Export Product List (CSV)</button>
    <input type="file" id="importFile" onchange="importData(event)">
  </div>

  <div style="margin-top:18px;">
    <h3 class="small">Imported Product Preview</h3>
    <div id="preview" class="small"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script src="app.js"></script>

  <script>
    // make the "O" act as the import button
    document.getElementById("importO").addEventListener("click", function() {
      const input = document.getElementById("csvFile");
      if (input) input.click();
    });
  </script>
</body>
</html>
